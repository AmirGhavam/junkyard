<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realistic 3D Coin Flip</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            perspective: 1200px;
            background-color: #0f172a;
            /* Slate 900 */
            color: #e2e8f0;
            overflow-x: hidden;
        }

        /* 3D Coin Construction */
        .coin-container {
            width: 220px;
            height: 220px;
            margin: 0 auto;
            position: relative;
            transform-style: preserve-3d;
            /* Using a bezier that starts fast and decelerates smoothly */
            transition: transform 3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .coin-face {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            backface-visibility: hidden;
            /* Hide back of this specific face */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            /* Slight Z translation to prevent z-fighting if we had thickness, 
               but here mostly to define the plane */
            -webkit-font-smoothing: antialiased;
        }

        /* Heads Design */
        .face-heads {
            background: radial-gradient(circle at 30% 30%, #ffd700, #daa520, #8b6508);
            color: #5c4033;
            transform: rotateY(0deg);
            border: 8px solid #b8860b;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.4), 0 0 20px rgba(0, 0, 0, 0.5);
        }

        /* Tails Design */
        .face-tails {
            background: radial-gradient(circle at 30% 30%, #e0e0e0, #bdbdbd, #757575);
            color: #424242;
            transform: rotateY(180deg);
            border: 8px solid #9e9e9e;
            box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.4), 0 0 20px rgba(0, 0, 0, 0.5);
        }

        /* Inner Ring for detail */
        .inner-ring {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            bottom: 10px;
            border: 2px dashed rgba(0, 0, 0, 0.2);
            border-radius: 50%;
            pointer-events: none;
        }

        .coin-svg {
            width: 80px;
            height: 80px;
            margin-bottom: 10px;
            filter: drop-shadow(0px 2px 3px rgba(0, 0, 0, 0.3));
        }

        .coin-text {
            font-size: 1.5rem;
            font-weight: 800;
            letter-spacing: 0.1em;
            text-shadow: 0px 1px 2px rgba(255, 255, 255, 0.2);
        }

        /* Confetti */
        @keyframes confetti-fall {
            0% {
                transform: translateY(-10vh) rotate(0deg) scale(1);
                opacity: 1;
            }

            100% {
                transform: translateY(110vh) rotate(720deg) scale(0.5);
                opacity: 0;
            }
        }

        .confetti {
            position: fixed;
            width: 12px;
            height: 12px;
            z-index: 50;
            pointer-events: none;
        }

        /* Pulse animation for winning streak */
        @keyframes pulse-green {

            0%,
            100% {
                box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7);
            }

            70% {
                box-shadow: 0 0 0 10px rgba(34, 197, 94, 0);
            }
        }

        .pulse-streak {
            animation: pulse-green 1.5s infinite;
        }

        /* Shine effect on coin */
        .shine {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0) 40%, rgba(255, 255, 255, 0.4) 50%, rgba(255, 255, 255, 0) 60%);
            opacity: 0.7;
            pointer-events: none;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col items-center justify-center p-4 selection:bg-yellow-500 selection:text-black">

    <!-- Header -->
    <div class="text-center mb-10 z-10">
        <h1
            class="text-5xl font-extrabold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 via-yellow-500 to-yellow-300 drop-shadow-sm">
            COIN FLIP
        </h1>
        <p class="text-slate-400 font-medium tracking-wide">HEADS OR TAILS?</p>
    </div>

    <!-- Stats Dashboard -->
    <div class="grid grid-cols-3 gap-4 mb-14 w-full max-w-lg">
        <!-- Heads Stat -->
        <div
            class="bg-slate-800/80 backdrop-blur-sm p-4 rounded-xl border border-slate-700 shadow-xl flex flex-col items-center transform hover:scale-105 transition-transform duration-200">
            <span class="text-xs text-slate-400 font-bold uppercase tracking-wider mb-1">Heads</span>
            <span id="heads-count" class="text-3xl font-black text-yellow-400">0</span>
        </div>

        <!-- Tails Stat -->
        <div
            class="bg-slate-800/80 backdrop-blur-sm p-4 rounded-xl border border-slate-700 shadow-xl flex flex-col items-center transform hover:scale-105 transition-transform duration-200">
            <span class="text-xs text-slate-400 font-bold uppercase tracking-wider mb-1">Tails</span>
            <span id="tails-count" class="text-3xl font-black text-slate-300">0</span>
        </div>

        <!-- Streak Stat -->
        <div id="streak-box"
            class="bg-slate-800/80 backdrop-blur-sm p-4 rounded-xl border border-slate-700 shadow-xl flex flex-col items-center relative overflow-hidden transition-all duration-300">
            <span class="text-xs text-slate-400 font-bold uppercase tracking-wider mb-1">Streak</span>
            <span id="streak-count" class="text-3xl font-black text-blue-400">0</span>
            <span id="streak-label"
                class="absolute bottom-1 text-[10px] text-slate-500 font-mono opacity-0 transition-opacity duration-300"></span>
        </div>
    </div>

    <!-- Coin Scene -->
    <div class="relative w-64 h-64 flex items-center justify-center mb-12 z-0">
        <!-- Shadow beneath coin -->
        <div class="absolute bottom-[-40px] w-32 h-8 bg-black/40 rounded-[100%] blur-md transition-all duration-300"
            id="coin-shadow"></div>

        <div id="coin" class="coin-container">
            <!-- Heads Face -->
            <div class="coin-face face-heads">
                <div class="inner-ring"></div>
                <div class="shine"></div>
                <svg class="coin-svg" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2l2.4 7.2h7.6l-6 4.8 2.4 7.2-6-4.8-6 4.8 2.4-7.2-6-4.8h7.6z" />
                </svg>
                <span class="coin-text">HEADS</span>
            </div>

            <!-- Tails Face -->
            <div class="coin-face face-tails">
                <div class="inner-ring"></div>
                <div class="shine"></div>
                <svg class="coin-svg" viewBox="0 0 24 24" fill="currentColor">
                    <path
                        d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"
                        style="display:none;" /> <!-- Checkmark hidden -->
                    <path
                        d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm3.23 15.39L12 15.45l-3.22 1.94.84-3.67-2.82-2.45 3.75-.32L12 7.55l1.45 3.4 3.75.32-2.82 2.45.84 3.67z" />
                    <!-- Star inside circle variant -->
                </svg>
                <span class="coin-text">TAILS</span>
            </div>
        </div>
    </div>

    <!-- Result Display -->
    <div class="h-16 flex items-center justify-center mb-6">
        <div id="result-text"
            class="text-3xl md:text-4xl font-black text-white tracking-widest opacity-0 scale-90 transition-all duration-300 drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]">
            HEADS
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex gap-6 z-10">
        <button id="flip-btn"
            class="group relative px-8 py-4 bg-gradient-to-b from-yellow-400 to-yellow-600 rounded-full shadow-[0_4px_0_rgb(161,98,7)] active:shadow-none active:translate-y-[4px] transition-all duration-150 outline-none focus:ring-4 ring-yellow-500/50">
            <span class="text-black font-extrabold text-xl tracking-wide group-hover:text-white transition-colors">FLIP
                COIN</span>
            <div class="absolute inset-0 rounded-full bg-white opacity-0 group-hover:opacity-20 transition-opacity">
            </div>
        </button>

        <button id="reset-btn"
            class="px-6 py-4 bg-slate-700 hover:bg-slate-600 text-slate-200 font-bold rounded-full shadow-[0_4px_0_rgb(51,65,85)] active:shadow-none active:translate-y-[4px] transition-all duration-150 outline-none focus:ring-4 ring-slate-500/50">
            RESET
        </button>
    </div>

    <!-- Footer -->
    <div class="mt-12 text-slate-600 text-sm">
        Simulated physics â€¢ Streak tracking active
    </div>

    <script>
        // DOM Elements
        const coin = document.getElementById('coin');
        const coinShadow = document.getElementById('coin-shadow');
        const flipBtn = document.getElementById('flip-btn');
        const resetBtn = document.getElementById('reset-btn');
        const headsCountEl = document.getElementById('heads-count');
        const tailsCountEl = document.getElementById('tails-count');
        const streakCountEl = document.getElementById('streak-count');
        const streakLabelEl = document.getElementById('streak-label');
        const streakBox = document.getElementById('streak-box');
        const resultTextEl = document.getElementById('result-text');

        // State variables
        let stats = {
            heads: 0,
            tails: 0,
            streak: 0,
            streakSide: null
        };

        let isFlipping = false;
        let currentRotation = 0; // accumulated rotation in degrees

        // Audio Context for synthesizing sounds
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        const audioCtx = new AudioContext();

        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();

            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();

            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);

            const now = audioCtx.currentTime;

            if (type === 'flip') {
                // Rising pitch sound
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(400, now);
                osc.frequency.linearRampToValueAtTime(800, now + 0.1);
                gainNode.gain.setValueAtTime(0.3, now);
                gainNode.gain.linearRampToValueAtTime(0, now + 0.3);
                osc.start(now);
                osc.stop(now + 0.3);
            } else if (type === 'land') {
                // Thud/Clink sound
                osc.type = 'sine';
                osc.frequency.setValueAtTime(300, now);
                osc.frequency.exponentialRampToValueAtTime(50, now + 0.15);
                gainNode.gain.setValueAtTime(0.5, now);
                gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.15);
                osc.start(now);
                osc.stop(now + 0.15);
            } else if (type === 'streak') {
                // High pitch success
                osc.type = 'square';
                osc.frequency.setValueAtTime(880, now);
                osc.frequency.exponentialRampToValueAtTime(1760, now + 0.1);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.linearRampToValueAtTime(0, now + 0.2);
                osc.start(now);
                osc.stop(now + 0.2);
            }
        }

        // Confetti Effect
        function launchConfetti(type) {
            const colors = type === 'heads'
                ? ['#fbbf24', '#d97706', '#fcd34d'] // Golds
                : ['#9ca3af', '#4b5563', '#e5e7eb']; // Silvers

            for (let i = 0; i < 40; i++) {
                const conf = document.createElement('div');
                conf.className = 'confetti';
                conf.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];

                // Random starting position near center
                const startX = 50 + (Math.random() * 20 - 10);
                conf.style.left = startX + 'vw';
                conf.style.top = '40vh';

                // Random spread logic for animation
                // We use inline styles for the specific end position calculation
                // but for simplicity here we rely on the CSS keyframe fall
                // and just randomize left position and delay.
                conf.style.left = Math.random() * 100 + 'vw';
                conf.style.animationDuration = (1.5 + Math.random() * 2) + 's';
                conf.style.animationDelay = Math.random() * 0.5 + 's';

                document.body.appendChild(conf);
                setTimeout(() => conf.remove(), 4000);
            }
        }

        function flipCoin() {
            if (isFlipping) return;
            isFlipping = true;

            // Disable UI
            flipBtn.classList.add('opacity-50', 'cursor-not-allowed', 'pointer-events-none');
            resultTextEl.classList.remove('opacity-100', 'scale-100');
            resultTextEl.classList.add('opacity-0', 'scale-90');

            // Reset Streak Highlight
            streakBox.classList.remove('pulse-streak', 'border-green-500', 'bg-green-900/30');

            playSound('flip');

            // 1. Decide Result (0 = Heads, 1 = Tails)
            const isHeads = Math.random() < 0.5;
            const target = isHeads ? 0 : 180; // 0deg for heads, 180deg for tails

            // 2. Calculate rotation
            // We want to rotate at least 5 times (5 * 360 = 1800)
            const spins = 5;
            const minRotation = 1800;

            // We need final rotation to be (n * 360) + target
            // Current rotation is `currentRotation`.
            // Let's add minRotation to currentRotation, then adjust to match target.

            let nextRotation = currentRotation + minRotation;

            // Adjust remainder to land on target
            // We want (nextRotation % 360) === target
            const remainder = nextRotation % 360;
            let difference = target - remainder;

            // Ensure we always add positive rotation to keep spinning forward
            if (difference < 0) {
                difference += 360;
            }

            nextRotation += difference;

            // Add extra randomness to number of spins for variability?
            // Let's keep it consistent 5 spins for predictability of animation time.
            // But we can add full 360s randomly.
            const extraSpins = Math.floor(Math.random() * 3) * 360;
            nextRotation += extraSpins;

            currentRotation = nextRotation;

            // 3. Apply CSS
            coin.style.transform = `rotateY(${currentRotation}deg)`;

            // Animate Shadow (shrink and grow)
            coinShadow.style.transform = 'scale(0.5)';
            coinShadow.style.opacity = '0.2';
            setTimeout(() => {
                coinShadow.style.transform = 'scale(1)';
                coinShadow.style.opacity = '0.4';
            }, 1500); // midway-ish

            // 4. Wait for end
            setTimeout(() => {
                handleResult(isHeads);
                isFlipping = false;
                flipBtn.classList.remove('opacity-50', 'cursor-not-allowed', 'pointer-events-none');
            }, 3000); // Must match CSS duration
        }

        function handleResult(isHeads) {
            playSound('land');

            // Update Text
            const text = isHeads ? "IT'S HEADS!" : "IT'S TAILS!";
            const colorClass = isHeads ? "text-yellow-400" : "text-slate-300";

            resultTextEl.textContent = text;
            resultTextEl.className = `text-3xl md:text-4xl font-black tracking-widest transition-all duration-300 drop-shadow-[0_0_10px_rgba(255,255,255,0.5)] opacity-100 scale-100 ${colorClass}`;

            // Update Counts
            if (isHeads) {
                stats.heads++;
                headsCountEl.textContent = stats.heads;
            } else {
                stats.tails++;
                tailsCountEl.textContent = stats.tails;
            }

            // Update Streak
            const side = isHeads ? 'heads' : 'tails';
            if (stats.streakSide === side) {
                stats.streak++;
                if (stats.streak > 1) {
                    playSound('streak'); // Extra sound for streak
                }
            } else {
                stats.streak = 1;
                stats.streakSide = side;
            }

            streakCountEl.textContent = stats.streak;
            streakLabelEl.textContent = side.toUpperCase();
            streakLabelEl.classList.remove('opacity-0');

            // Visual feedback for streak
            if (stats.streak >= 3) {
                streakBox.classList.add('pulse-streak', 'border-green-500', 'bg-green-900/30');
            }

            launchConfetti(side);
        }

        function resetGame() {
            if (isFlipping) return;
            stats = { heads: 0, tails: 0, streak: 0, streakSide: null };
            headsCountEl.textContent = '0';
            tailsCountEl.textContent = '0';
            streakCountEl.textContent = '0';
            streakLabelEl.classList.add('opacity-0');

            resultTextEl.classList.remove('opacity-100');
            resultTextEl.classList.add('opacity-0');

            streakBox.classList.remove('pulse-streak', 'border-green-500', 'bg-green-900/30');
        }

        flipBtn.addEventListener('click', flipCoin);
        resetBtn.addEventListener('click', resetGame);

    </script>
</body>

</html>