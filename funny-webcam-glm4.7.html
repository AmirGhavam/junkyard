<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Funny Webcam Filters ðŸŽ­</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        @keyframes bounce-slow {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes rainbow {
            0% {
                filter: hue-rotate(0deg);
            }

            100% {
                filter: hue-rotate(360deg);
            }
        }

        @keyframes wiggle {

            0%,
            100% {
                transform: rotate(-3deg);
            }

            50% {
                transform: rotate(3deg);
            }
        }

        .filter-active {
            box-shadow: 0 0 20px rgba(139, 92, 246, 0.8);
            border-color: #8b5cf6 !important;
        }
    </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-purple-900 via-indigo-900 to-pink-800 text-white">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold mb-2">ðŸŽ­ Funny Webcam Filters</h1>
            <p class="text-purple-200">Click a filter and start having fun!</p>
        </header>

        <div class="flex flex-col lg:flex-row gap-8 items-start justify-center">
            <!-- Video Container -->
            <div class="flex-1 max-w-3xl mx-auto lg:mx-0">
                <div class="relative bg-black rounded-2xl overflow-hidden shadow-2xl">
                    <video id="video" autoplay playsinline class="w-full aspect-video object-cover"></video>
                    <canvas id="canvas" class="absolute inset-0 w-full h-full pointer-events-none"></canvas>

                    <!-- Overlay elements for certain filters -->
                    <div id="overlays" class="absolute inset-0 pointer-events-none hidden">
                        <!-- Clown Nose -->
                        <div id="clown-nose"
                            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-red-500 rounded-full opacity-0 hidden"
                            style="box-shadow: inset -8px -8px 20px rgba(0,0,0,0.3), inset 8px 8px 20px rgba(255,255,255,0.2);">
                        </div>

                        <!-- Emoji overlay -->
                        <div id="emoji-overlay"
                            class="absolute inset-0 flex items-center justify-center opacity-0 hidden">
                            <span id="emoji-display" class="text-9xl"></span>
                        </div>
                    </div>

                    <!-- Start Button -->
                    <div id="start-screen"
                        class="absolute inset-0 flex flex-col items-center justify-center bg-black/70 z-10">
                        <div class="text-6xl mb-4">ðŸ“·</div>
                        <button id="start-btn"
                            class="px-8 py-4 bg-gradient-to-r from-pink-500 to-purple-600 rounded-full text-xl font-bold hover:from-pink-600 hover:to-purple-700 transform hover:scale-105 transition-all shadow-lg">
                            Start Camera
                        </button>
                    </div>
                </div>

                <!-- Screenshot Button -->
                <div class="flex justify-center mt-4 gap-4">
                    <button id="screenshot-btn"
                        class="px-6 py-3 bg-gradient-to-r from-green-500 to-teal-600 rounded-full font-bold hover:from-green-600 hover:to-teal-700 transform hover:scale-105 transition-all shadow-lg flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed"
                        disabled>
                        <span>ðŸ“¸</span> Take Screenshot
                    </button>
                    <button id="mirror-btn"
                        class="px-6 py-3 bg-gradient-to-r from-orange-500 to-red-600 rounded-full font-bold hover:from-orange-600 hover:to-red-700 transform hover:scale-105 transition-all shadow-lg flex items-center gap-2">
                        <span>ðŸ”„</span> Mirror
                    </button>
                </div>
            </div>

            <!-- Filters Panel -->
            <div class="w-full lg:w-80 bg-white/10 backdrop-blur-sm rounded-2xl p-6">
                <h2 class="text-2xl font-bold mb-4 text-center">âœ¨ Filters</h2>
                <div class="grid grid-cols-3 lg:grid-cols-2 gap-3" id="filters-container">
                    <!-- Filters will be added by JS -->
                </div>

                <div class="mt-6">
                    <h3 class="font-semibold mb-2 text-purple-200">ðŸŽ¨ Adjustments</h3>
                    <div class="space-y-3">
                        <div>
                            <label class="text-sm text-purple-300">Brightness</label>
                            <input type="range" id="brightness" min="50" max="150" value="100"
                                class="w-full accent-purple-500">
                        </div>
                        <div>
                            <label class="text-sm text-purple-300">Contrast</label>
                            <input type="range" id="contrast" min="50" max="150" value="100"
                                class="w-full accent-purple-500">
                        </div>
                        <div>
                            <label class="text-sm text-purple-300">Saturation</label>
                            <input type="range" id="saturation" min="0" max="200" value="100"
                                class="w-full accent-purple-500">
                        </div>
                    </div>
                    <button id="reset-adjustments"
                        class="w-full mt-4 py-2 bg-white/20 rounded-lg hover:bg-white/30 transition text-sm">
                        Reset Adjustments
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Screenshot preview modal -->
    <div id="screenshot-modal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-2xl p-4 max-w-2xl mx-4">
            <img id="screenshot-preview" class="rounded-lg max-w-full" alt="Screenshot">
            <div class="flex justify-center gap-4 mt-4">
                <a id="download-btn" download="funny-screenshot.png"
                    class="px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition">Download</a>
                <button id="close-modal"
                    class="px-6 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition">Close</button>
            </div>
        </div>
    </div>

    <script>
        const video = document.getElementById('video');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const startBtn = document.getElementById('start-btn');
        const startScreen = document.getElementById('start-screen');
        const screenshotBtn = document.getElementById('screenshot-btn');
        const mirrorBtn = document.getElementById('mirror-btn');
        const filtersContainer = document.getElementById('filters-container');
        const screenshotModal = document.getElementById('screenshot-modal');
        const screenshotPreview = document.getElementById('screenshot-preview');
        const downloadBtn = document.getElementById('download-btn');
        const closeModal = document.getElementById('close-modal');

        let stream = null;
        let currentFilter = 'normal';
        let isMirrored = false;
        let animationId = null;
        let facePosition = { x: 0.5, y: 0.5 };

        const filters = [
            { id: 'normal', name: 'Normal', emoji: 'ðŸ˜Š', css: '' },
            { id: 'grayscale', name: 'B&W', emoji: 'ðŸ–¤', css: 'grayscale(100%)' },
            { id: 'sepia', name: 'Vintage', emoji: 'ðŸ“œ', css: 'sepia(100%)' },
            { id: 'invert', name: 'Invert', emoji: 'ðŸŒ—', css: 'invert(100%)' },
            { id: 'saturate', name: 'Vivid', emoji: 'ðŸŒˆ', css: 'saturate(200%)' },
            { id: 'hue', name: 'Alien', emoji: 'ðŸ‘½', css: 'hue-rotate(90deg) saturate(150%)' },
            { id: 'blur', name: 'Dreamy', emoji: 'ðŸ’­', css: 'blur(2px) brightness(110%)' },
            { id: 'contrast', name: 'Dramatic', emoji: 'ðŸŽ­', css: 'contrast(150%) saturate(120%)' },
            { id: 'warm', name: 'Warm', emoji: 'ðŸŒ…', css: 'sepia(30%) saturate(140%)' },
            { id: 'cool', name: 'Cool', emoji: 'â„ï¸', css: 'hue-rotate(180deg) saturate(80%)' },
            { id: 'matrix', name: 'Matrix', emoji: 'ðŸ’š', css: 'hue-rotate(100deg) saturate(300%) contrast(120%)' },
            { id: 'psychedelic', name: 'Psychedelic', emoji: 'ðŸ¦„', css: 'hue-rotate(45deg) saturate(200%) contrast(120%)' },
        ];

        // Create filter buttons
        filters.forEach(filter => {
            const btn = document.createElement('button');
            btn.className = `p-3 rounded-xl border-2 border-white/30 hover:border-white/60 transition-all flex flex-col items-center gap-1 ${filter.id === 'normal' ? 'filter-active' : ''}`;
            btn.innerHTML = `<span class="text-2xl">${filter.emoji}</span><span class="text-xs">${filter.name}</span>`;
            btn.addEventListener('click', () => selectFilter(filter.id, btn));
            filtersContainer.appendChild(btn);
        });

        function selectFilter(filterId, btn) {
            currentFilter = filterId;
            document.querySelectorAll('#filters-container button').forEach(b => b.classList.remove('filter-active'));
            btn.classList.add('filter-active');
            applyFilter();
        }

        function applyFilter() {
            const filter = filters.find(f => f.id === currentFilter);
            const brightness = document.getElementById('brightness').value;
            const contrast = document.getElementById('contrast').value;
            const saturation = document.getElementById('saturation').value;

            let filterString = filter ? filter.css : '';
            filterString += ` brightness(${brightness}%) contrast(${contrast}%) saturate(${saturation}%)`;

            video.style.filter = filterString;
            canvas.style.filter = filterString;
        }

        // Adjustment sliders
        ['brightness', 'contrast', 'saturation'].forEach(id => {
            document.getElementById(id).addEventListener('input', applyFilter);
        });

        document.getElementById('reset-adjustments').addEventListener('click', () => {
            document.getElementById('brightness').value = 100;
            document.getElementById('contrast').value = 100;
            document.getElementById('saturation').value = 100;
            applyFilter();
        });

        // Mirror toggle
        mirrorBtn.addEventListener('click', () => {
            isMirrored = !isMirrored;
            video.style.transform = isMirrored ? 'scaleX(-1)' : 'scaleX(1)';
            canvas.style.transform = isMirrored ? 'scaleX(-1)' : 'scaleX(1)';
            mirrorBtn.classList.toggle('ring-2', isMirrored);
            mirrorBtn.classList.toggle('ring-white', isMirrored);
        });

        // Start camera
        startBtn.addEventListener('click', async () => {
            try {
                stream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        width: { ideal: 1280 },
                        height: { ideal: 720 },
                        facingMode: 'user'
                    }
                });
                video.srcObject = stream;
                startScreen.classList.add('hidden');
                screenshotBtn.disabled = false;

                video.addEventListener('loadedmetadata', () => {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    startDrawing();
                });
            } catch (err) {
                alert('Could not access camera. Please make sure you have granted permission.');
                console.error(err);
            }
        });

        // Draw fun overlays
        let time = 0;
        function startDrawing() {
            function draw() {
                time += 0.05;
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                const w = canvas.width;
                const h = canvas.height;
                const cx = w / 2;
                const cy = h / 2;

                // Draw different fun overlays based on filter
                if (currentFilter === 'normal') {
                    drawFloatingEmojis(ctx, w, h);
                } else if (currentFilter === 'dreamy') {
                    drawSparkles(ctx, w, h);
                } else if (currentFilter === 'matrix') {
                    drawMatrixRain(ctx, w, h);
                } else if (currentFilter === 'psychedelic') {
                    drawSwirls(ctx, w, h, time);
                } else if (currentFilter === 'vivid') {
                    drawRainbowBorder(ctx, w, h, time);
                }

                animationId = requestAnimationFrame(draw);
            }
            draw();
        }

        function drawFloatingEmojis(ctx, w, h) {
            const emojis = ['ðŸ˜€', 'ðŸ˜Ž', 'ðŸ¤©', 'ðŸ˜‚', 'ðŸ¥³', 'ðŸ˜œ', 'ðŸ¤ª', 'ðŸ˜‹'];
            ctx.font = '40px Arial';
            ctx.textAlign = 'center';

            for (let i = 0; i < 5; i++) {
                const x = (Math.sin(time * 0.5 + i * 1.5) * 0.4 + 0.5) * w;
                const y = (Math.cos(time * 0.3 + i * 2) * 0.3 + 0.5) * h;
                ctx.globalAlpha = 0.3;
                ctx.fillText(emojis[i % emojis.length], x, y);
            }
            ctx.globalAlpha = 1;
        }

        function drawSparkles(ctx, w, h) {
            for (let i = 0; i < 20; i++) {
                const x = (Math.sin(time + i) * 0.5 + 0.5) * w;
                const y = (Math.cos(time * 0.7 + i * 0.5) * 0.5 + 0.5) * h;
                const size = (Math.sin(time * 2 + i) * 0.5 + 1) * 15;

                ctx.save();
                ctx.translate(x, y);
                ctx.rotate(time + i);
                ctx.fillStyle = `hsla(${(time * 50 + i * 30) % 360}, 100%, 80%, 0.8)`;
                ctx.beginPath();
                for (let j = 0; j < 5; j++) {
                    const angle = (j * Math.PI * 2) / 5 - Math.PI / 2;
                    const r = j % 2 === 0 ? size : size / 2;
                    ctx.lineTo(Math.cos(angle) * r, Math.sin(angle) * r);
                }
                ctx.closePath();
                ctx.fill();
                ctx.restore();
            }
        }

        function drawMatrixRain(ctx, w, h) {
            ctx.font = '20px monospace';
            ctx.fillStyle = '#0f0';

            for (let i = 0; i < 15; i++) {
                const x = (i * w / 15 + time * 10) % w;
                const y = (time * 50 + i * 100) % h;
                ctx.globalAlpha = 0.3;
                ctx.fillText(String.fromCharCode(0x30A0 + Math.random() * 96), x, y);
            }
            ctx.globalAlpha = 1;
        }

        function drawSwirls(ctx, w, h, time) {
            for (let i = 0; i < 3; i++) {
                ctx.strokeStyle = `hsla(${(time * 30 + i * 120) % 360}, 100%, 60%, 0.5)`;
                ctx.lineWidth = 3;
                ctx.beginPath();
                for (let t = 0; t < Math.PI * 4; t += 0.1) {
                    const x = w / 2 + Math.cos(t + time + i) * (100 + i * 50);
                    const y = h / 2 + Math.sin(t * 2 + time) * (50 + i * 30);
                    if (t === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
            }
        }

        function drawRainbowBorder(ctx, w, h, time) {
            const borderWidth = 20;
            for (let i = 0; i < 360; i += 2) {
                const hue = (i + time * 50) % 360;
                ctx.strokeStyle = `hsl(${hue}, 100%, 60%)`;
                ctx.lineWidth = 2;

                const angle = (i * Math.PI) / 180;
                const x1 = w / 2 + Math.cos(angle) * (w / 2 - borderWidth);
                const y1 = h / 2 + Math.sin(angle) * (h / 2 - borderWidth);
                const x2 = w / 2 + Math.cos(angle) * w / 2;
                const y2 = h / 2 + Math.sin(angle) * h / 2;

                ctx.beginPath();
                ctx.moveTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.stroke();
            }
        }

        // Screenshot functionality
        screenshotBtn.addEventListener('click', () => {
            const captureCanvas = document.createElement('canvas');
            captureCanvas.width = video.videoWidth;
            captureCanvas.height = video.videoHeight;
            const captureCtx = captureCanvas.getContext('2d');

            // Apply mirror if enabled
            if (isMirrored) {
                captureCtx.translate(captureCanvas.width, 0);
                captureCtx.scale(-1, 1);
            }

            // Draw video with filters
            const filter = filters.find(f => f.id === currentFilter);
            const brightness = document.getElementById('brightness').value;
            const contrast = document.getElementById('contrast').value;
            const saturation = document.getElementById('saturation').value;
            let filterString = filter ? filter.css : '';
            filterString += ` brightness(${brightness}%) contrast(${contrast}%) saturate(${saturation}%)`;
            captureCtx.filter = filterString;

            captureCtx.drawImage(video, 0, 0);

            // Draw overlay canvas
            captureCtx.filter = 'none';
            captureCtx.drawImage(canvas, 0, 0);

            const dataUrl = captureCanvas.toDataURL('image/png');
            screenshotPreview.src = dataUrl;
            downloadBtn.href = dataUrl;
            screenshotModal.classList.remove('hidden');
        });

        closeModal.addEventListener('click', () => {
            screenshotModal.classList.add('hidden');
        });

        screenshotModal.addEventListener('click', (e) => {
            if (e.target === screenshotModal) {
                screenshotModal.classList.add('hidden');
            }
        });

        // Cleanup
        window.addEventListener('beforeunload', () => {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
        });
    </script>
</body>

</html>